<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1">
  <title>Recover Accidentally Removed DFS Namespace Folders and Targets ¬∑ Windows Server Talks</title>

  <!-- Theme color for mobile address bar -->
  <meta name="theme-color" content="#0F6CBD">

  <!-- Copilot/Fluent-styled CSS (your existing stylesheet) -->
  <link rel="stylesheet" href="https://mauryamohit07.github.io/WindowsServerTalks/assets/css/custom.css">

  <!-- Small site enhancements (copy buttons, lightbox, active link) -->
  <script src="https://mauryamohit07.github.io/WindowsServerTalks/assets/js/site.js" defer></script>
</head>
<body>
  <a class="skip-link" href="#main-content">Skip to content</a>

  <!-- ===== Fixed Header (as requested) ===== -->
  <header class="site-header">
    <div class="container">
      <h1>Windows Server Talks</h1>
      <p class="tagline">
        DFS, Active Directory, Hyper‚ÄëV, and PowerShell guides by Mohit Maurya
      </p>

      <nav class="breadcrumbs" aria-label="Breadcrumb">
        <a href="https://mauryamohit07.github.io/WindowsServerTalks/index.html">Home</a>
        <span aria-hidden="true">‚Ä∫</span>
        <span aria-current="page">Recover Deleted DFS‚ÄëN Links</span>
      </nav>
    </div>
  </header>

  <div class="layout container">
    <!-- ===== Left pane (slightly grey) ===== -->
    <nav class="sidebar" aria-label="Primary">
      <h3>üìö Contents</h3>
      <ul>
        <li>
          <a href="https://mauryamohit07.github.io/WindowsServerTalks/domain-based-dfs-n-auto-backup.html">
            DFS‚ÄëN Auto Backup
          </a>
        </li>
        <li>
          <a href="https://mauryamohit07.github.io/WindowsServerTalks/recover-deleted-dfs-n-links.html" aria-current="page">
            Recover Deleted DFS‚ÄëN Links
          </a>
        </li>
        <li>
          <a href="https://mauryamohit07.github.io/WindowsServerTalks/index.html">‚Üê Back to Home</a>
        </li>
      </ul>
    </nav>

    <!-- ===== Main content (a little lighter grey) ===== -->
    <main id="main-content" class="content" role="main">
      <h2 class="page-title">Recover Accidentally Removed Namespace Folders and Targets</h2>
      <p class="page-subtitle">Using Active Directory Recycle Bin (DFS‚ÄëN)</p>

      <section class="summary-box">
        <h3>Summary</h3>
        <p>
          This guide explains how to <strong>recover accidentally deleted DFS namespace
          links and their targets</strong> using <strong>Active Directory Recycle Bin</strong>.
        </p>
      </section>

      <div class="callout warning">
        <strong>Important:</strong>
        Only <strong>subfolders (DFS links)</strong> and their <strong>targets</strong> can be
        recovered using this method.<br>
        <strong>Entire namespace deletion</strong> requires DFS namespace backups.
      </div>

      <h2 class="step-title">Step 1 ‚Äî Discover Deleted DFS Namespace Links</h2>
      <p class="step-desc">
        This step queries Active Directory for deleted <code>msDFS-Linkv2</code> objects,
        calculates deletion age, and displays the results for review.
      </p>

      <pre><code class="language-powershell">
Import-Module ActiveDirectory
$LogFolder = "C:\DFSlogs"
if (!(Test-Path -Path $LogFolder)) {
  New-Item -Path $LogFolder -ItemType Directory | Out-Null
}
$CurrentDate = Get-Date
$DeletedDFSObjects = Get-ADObject `
  -Filter 'ObjectClass -eq "msDFS-Linkv2" -and isDeleted -eq $true' `
  -IncludeDeletedObjects `
  -Properties DistinguishedName, Name, ObjectClass, whenChanged, ObjectGUID

$Result = $DeletedDFSObjects |
  Select-Object `
    Name, ObjectClass, DistinguishedName,
    @{Name="ObjectGUID"; Expression={$_.ObjectGUID}},
    @{Name="DeletedOn";  Expression={($_.whenChanged).ToString("dd-MMM-yyyy HH:mm")}},
    @{Name="Age";        Expression={
      if ($_.whenChanged) {
        $diff = $CurrentDate - $_.whenChanged
        if ($diff.Days -ge 1) { "$($diff.Days) days ago" }
        else { "$([math]::Round($diff.TotalHours,1)) hours ago" }
      } else { "N/A" }
    }}

$Result | Out-GridView -Title "Deleted DFS Links Report"
      </code></pre>

      <h2>Sample Output</h2>
      <figure>
        <img class="doc-image"
             src="https://mauryamohit07.github.io/WindowsServerTalks/assets/images/image4.png"
             alt="Out-GridView sample showing deleted DFS links">
        <figcaption>
          Out‚ÄëGridView output showing deleted DFS links with ObjectGUID and age.
        </figcaption>
      </figure>

      <figure>
        <img class="doc-image"
             src="https://mauryamohit07.github.io/WindowsServerTalks/assets/images/image5.png"
             alt="CSV export showing deleted DFS links">
        <figcaption>
          CSV export used to filter links before bulk restore.
        </figcaption>
      </figure>

      <h2>Expected Results</h2>
      <figure>
        <img class="doc-image"
             src="https://mauryamohit07.github.io/WindowsServerTalks/assets/images/image6.png"
             alt="Restored DFS links">
        <figcaption>
          Restored DFS links visible after successful recovery.
        </figcaption>
      </figure>

      <figure>
        <img class="doc-image"
             src="https://mauryamohit07.github.io/WindowsServerTalks/assets/images/image7.png"
             alt="DFS restore log output">
        <figcaption>
          Restore log confirming successful object recovery.
        </figcaption>
      </figure>
    </main>
  </div>

  <footer class="site-footer">
    <div class="container">
      <p>¬© 2026 Mohit Maurya ¬∑ Windows Server Talks</p>
    </div>
  </footer>
</body>
</html>
